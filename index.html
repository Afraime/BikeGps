<script>
  // Firebase Configuration
  var firebaseConfig = {
    apiKey: "AIzaSyDiSckMMD055k9cxend3oesbv2B2MBwOjI",
    databaseURL: "https://bikegps-1ae85-default-rtdb.asia-southeast1.firebasedatabase.app"
  };

  firebase.initializeApp(firebaseConfig);
  var db = firebase.database();

  // Initialize Map (Dhaka default)
  var map = L.map('map').setView([23.81, 90.41], 13);

  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: 'Â© OpenStreetMap'
  }).addTo(map);

  var marker = L.marker([23.81, 90.41]).addTo(map);

  // Listen for GPS updates
  db.ref("bikeTracker").on("value", function(snapshot) {
    var data = snapshot.val();

    if (data && data.latitude && data.longitude) {

      var lat = parseFloat(data.latitude);
      var lng = parseFloat(data.longitude);
      var speed = parseFloat(data.speed || 0);

      // Move marker
      marker.setLatLng([lat, lng]);

      // Center map
      map.setView([lat, lng], 15);

      // Update info
      document.getElementById("info").innerHTML =
        "<strong>Latitude:</strong> " + lat.toFixed(6) + "<br>" +
        "<strong>Longitude:</strong> " + lng.toFixed(6) + "<br>" +
        "<strong>Speed:</strong> " + speed.toFixed(1) + " km/h";

      document.getElementById("speed-value").textContent = speed.toFixed(1);

      document.getElementById("last-update").textContent =
        "Last update: " + new Date().toLocaleTimeString();

      document.getElementById("status").innerHTML = "Live";
    }
  });
</script>
